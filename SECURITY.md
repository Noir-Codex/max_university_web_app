# üîí –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ MAX Attendance Tracker

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, best practices –∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–ª—è MAX Attendance Tracker.

---

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏](#-–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ-–≤–µ—Ä—Å–∏–∏)
2. [–°–æ–æ–±—â–∏—Ç—å –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏](#-—Å–æ–æ–±—â–∏—Ç—å-–æ–±-—É—è–∑–≤–∏–º–æ—Å—Ç–∏)
3. [–ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#-–º–µ—Ä—ã-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
4. [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
5. [–ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö](#-–∑–∞—â–∏—Ç–∞-–¥–∞–Ω–Ω—ã—Ö)
6. [Best Practices](#-best-practices)
7. [GDPR —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ](#-gdpr-—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ)
8. [Security Checklist](#-security-checklist)

---

## üõ° –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏

–ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –≤–µ—Ä—Å–∏–π:

| –í–µ—Ä—Å–∏—è | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ | –ö–æ–Ω–µ—Ü –ø–æ–¥–¥–µ—Ä–∂–∫–∏ |
|--------|-----------|-----------------|
| 1.0.x  | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è | - |
| 0.9.x  | ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ | 2024-12-31 |
| < 0.9  | ‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | - |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é.

---

## üö® –°–æ–æ–±—â–∏—Ç—å –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ!

–ï—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:

**–ù–ï** —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π Issue –Ω–∞ GitHub.

**–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:**

1. –ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞ **security@yourdomain.com**
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞—à PGP –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```
   Fingerprint: XXXX XXXX XXXX XXXX XXXX
   ```
3. –ò–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ MAX: **@MaxAttendanceSecurityBot**

### –ß—Ç–æ –≤–∫–ª—é—á–∏—Ç—å –≤ –æ—Ç—á–µ—Ç?

- **–û–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- **–®–∞–≥–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:** –ö–∞–∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å
- **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ:** –û—Ü–µ–Ω–∫–∞ —Å–µ—Ä—å—ë–∑–Ω–æ—Å—Ç–∏
- **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:** –ï—Å–ª–∏ –µ—Å—Ç—å –∏–¥–µ–∏
- **–í–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã:** –î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Å–≤—è–∑–∏

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è** - –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤
2. **–ü–µ—Ä–≤–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞** - –≤ —Ç–µ—á–µ–Ω–∏–µ 7 –¥–Ω–µ–π
3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ä—å—ë–∑–Ω–æ—Å—Ç–∏:
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è: 1-3 –¥–Ω—è
   - –í—ã—Å–æ–∫–∞—è: 7-14 –¥–Ω–µ–π
   - –°—Ä–µ–¥–Ω—è—è: 30 –¥–Ω–µ–π
   - –ù–∏–∑–∫–∞—è: —Å–ª–µ–¥—É—é—â–∏–π —Ä–µ–ª–∏–∑
4. **–ü—É–±–ª–∏–∫–∞—Ü–∏—è fix** –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—é

### –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π

–ú—ã –±–ª–∞–≥–æ–¥–∞—Ä–∏–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

- **–ü—É–±–ª–∏—á–Ω–∞—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å** –≤ CHANGELOG
- **–£–ø–æ–º–∏–Ω–∞–Ω–∏–µ** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Security Hall of Fame
- **–î–µ–Ω–µ–∂–Ω–æ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ** (–¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π):
  - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è: $500-2000
  - –í—ã—Å–æ–∫–∞—è: $200-500
  - –°—Ä–µ–¥–Ω—è—è: $50-200

---

## üîê –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Transport Security

‚úÖ **HTTPS –≤–µ–∑–¥–µ**
- –í—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è TLS 1.2+
- HSTS –≤–∫–ª—é—á–µ–Ω (Strict-Transport-Security)
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –æ—Ç Let's Encrypt –∏–ª–∏ –Ω–∞–¥—ë–∂–Ω—ã—Ö CA

```nginx
# nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
```

### Database Security

‚úÖ **SSL/TLS –¥–ª—è PostgreSQL**
```javascript
// server/config/database.js
const pool = new Pool({
  ssl: {
    rejectUnauthorized: true,
    ca: fs.readFileSync(process.env.DB_SSL_CERT_PATH)
  }
});
```

‚úÖ **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**
```javascript
// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –∑–∞—â–∏—Ç–∞ –æ—Ç SQL injection
const result = await pool.query(
  'SELECT * FROM users WHERE id = $1',
  [userId]
);

// ‚ùå –ù–ò–ö–û–ì–î–ê —Ç–∞–∫ –Ω–µ –¥–µ–ª–∞–π—Ç–µ!
const result = await pool.query(
  `SELECT * FROM users WHERE id = ${userId}`
);
```

‚úÖ **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏**
```sql
-- –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
CREATE USER app_user WITH PASSWORD 'secure_password';
GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO app_user;
REVOKE CREATE ON SCHEMA public FROM app_user;
```

### Application Security

‚úÖ **Helmet –¥–ª—è HTTP headers**
```javascript
// server/server.js
const helmet = require('helmet');

app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"],
    }
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  }
}));
```

‚úÖ **Rate Limiting**
```javascript
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  max: 100, // –º–∞–∫—Å 100 –∑–∞–ø—Ä–æ—Å–æ–≤
  message: 'Too many requests from this IP'
});

app.use('/api/', limiter);

// –°—Ç—Ä–æ–∂–µ –¥–ª—è –ª–æ–≥–∏–Ω–∞
const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 5,
  message: 'Too many login attempts'
});

app.use('/api/auth/login', loginLimiter);
```

‚úÖ **CORS –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω**
```javascript
const cors = require('cors');

app.use(cors({
  origin: process.env.ALLOWED_ORIGINS.split(','),
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE'],
  allowedHeaders: ['Content-Type', 'Authorization', 'X-Init-Data']
}));
```

‚úÖ **Input Validation**
```javascript
const { body, validationResult } = require('express-validator');

const validateUser = [
  body('email').isEmail().normalizeEmail(),
  body('first_name').trim().isLength({ min: 1, max: 100 }),
  body('role').isIn(['student', 'teacher', 'admin']),
  (req, res, next) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({ errors: errors.array() });
    }
    next();
  }
];
```

‚úÖ **XSS Protection**
```javascript
// –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
import DOMPurify from 'dompurify';

const sanitizedHTML = DOMPurify.sanitize(userInput);

// –ù–∞ –±—ç–∫–µ–Ω–¥–µ
const xss = require('xss');
const clean = xss(userInput);
```

---

## üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### MAX WebApp initData Validation

**‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ:** –í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ initData –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!

```javascript
const crypto = require('crypto');

function validateInitData(initData, botToken) {
  const params = new URLSearchParams(initData);
  const hash = params.get('hash');
  params.delete('hash');
  
  const dataCheckString = Array.from(params.entries())
    .sort(([a], [b]) => a.localeCompare(b))
    .map(([key, value]) => `${key}=${value}`)
    .join('\n');
  
  const secretKey = crypto
    .createHmac('sha256', 'WebAppData')
    .update(botToken)
    .digest();
  
  const calculatedHash = crypto
    .createHmac('sha256', secretKey)
    .update(dataCheckString)
    .digest('hex');
  
  return calculatedHash === hash;
}
```

### JWT Tokens

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç**
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
```javascript
const jwt = require('jsonwebtoken');

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
const token = jwt.sign(
  { 
    userId: user.id,
    role: user.role 
  },
  process.env.JWT_SECRET,
  { 
    expiresIn: '7d',
    algorithm: 'HS256'
  }
);

// –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
jwt.verify(token, process.env.JWT_SECRET, (err, decoded) => {
  if (err) {
    return res.status(401).json({ error: 'Invalid token' });
  }
  req.user = decoded;
  next();
});
```

‚úÖ **–•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ**
```javascript
// –í localStorage (–¥–ª—è WebApp - OK)
localStorage.setItem('auth_token', token);

// ‚ùå –ù–ò–ö–û–ì–î–ê –≤ cookies –±–µ–∑ httpOnly –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
// ‚ùå –ù–ò–ö–û–ì–î–ê –≤ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
// ‚ùå –ù–ò–ö–û–ì–î–ê –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤ –ª–æ–≥–∏
```

### Role-Based Access Control (RBAC)

```javascript
// middleware/roles.js
const requireAdmin = (req, res, next) => {
  if (req.user.role !== 'admin') {
    return res.status(403).json({ 
      error: 'Access denied. Admin role required.' 
    });
  }
  next();
};

const requireTeacher = (req, res, next) => {
  if (!['teacher', 'admin'].includes(req.user.role)) {
    return res.status(403).json({ 
      error: 'Access denied. Teacher role required.' 
    });
  }
  next();
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
router.post('/users', authenticateToken, requireAdmin, createUser);
router.post('/attendance', authenticateToken, requireTeacher, saveAttendance);
```

### Password Security

‚úÖ **Bcrypt –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**
```javascript
const bcrypt = require('bcrypt');

// –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
const saltRounds = 12; // –ú–∏–Ω–∏–º—É–º 10, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 12+
const hashedPassword = await bcrypt.hash(password, saltRounds);

// –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
const isValid = await bcrypt.compare(password, hashedPassword);
```

‚úÖ **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—è–º**
- –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
- –ú–∏–Ω–∏–º—É–º 1 –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞
- –ú–∏–Ω–∏–º—É–º 1 —Å—Ç—Ä–æ—á–Ω–∞—è –±—É–∫–≤–∞
- –ú–∏–Ω–∏–º—É–º 1 —Ü–∏—Ñ—Ä–∞
- –ú–∏–Ω–∏–º—É–º 1 —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª

```javascript
const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

if (!passwordRegex.test(password)) {
  throw new Error('Password does not meet requirements');
}
```

---

## üõ° –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

### –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –º—ã —Ö—Ä–∞–Ω–∏–º:**
- Telegram ID (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è
- Username
- Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –†–æ–ª—å –≤ —Å–∏—Å—Ç–µ–º–µ
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏

**–ü—Ä–∏–Ω—Ü–∏–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- ‚úÖ –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ (HTTPS)
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- ‚úÖ –ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–í transit:** TLS 1.2+

**At rest (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
```javascript
const crypto = require('crypto');

// –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
function encrypt(text, key) {
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv(
    'aes-256-gcm', 
    Buffer.from(key, 'hex'), 
    iv
  );
  
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  
  const authTag = cipher.getAuthTag();
  
  return {
    encrypted,
    iv: iv.toString('hex'),
    authTag: authTag.toString('hex')
  };
}

// –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
function decrypt(encrypted, key, iv, authTag) {
  const decipher = crypto.createDecipheriv(
    'aes-256-gcm',
    Buffer.from(key, 'hex'),
    Buffer.from(iv, 'hex')
  );
  
  decipher.setAuthTag(Buffer.from(authTag, 'hex'));
  
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  
  return decrypted;
}
```

### Backup –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

‚úÖ **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã**
```bash
#!/bin/bash
# backup-db.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/var/backups/postgresql"

# –ë—ç–∫–∞–ø —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
pg_dump -h $DB_HOST -U $DB_USER -d $DB_NAME | \
  gzip | \
  openssl enc -aes-256-cbc -salt -pbkdf2 -pass pass:$BACKUP_PASSWORD \
  > $BACKUP_DIR/backup_$DATE.sql.gz.enc

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.enc" -mtime +30 -delete
```

‚úÖ **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
openssl enc -aes-256-cbc -d -pbkdf2 -pass pass:$BACKUP_PASSWORD \
  -in backup.sql.gz.enc | \
  gunzip | \
  psql -h $DB_HOST -U $DB_USER -d $DB_NAME
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

‚úÖ **–ß—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å:**
- –ü–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ (—É—Å–ø–µ—à–Ω—ã–µ –∏ –Ω–µ—É—Å–ø–µ—à–Ω—ã–µ)
- –î–æ—Å—Ç—É–ø –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—à–∏–±–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- API –∑–∞–ø—Ä–æ—Å—ã (–±–µ–∑ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

‚úÖ **–ß—Ç–æ –ù–ï –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å:**
- –ü–∞—Ä–æ–ª–∏
- JWT —Ç–æ–∫–µ–Ω—ã
- –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –∫–∞—Ä—Ç
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

```javascript
// Winston logger
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.File({ 
      filename: 'error.log', 
      level: 'error' 
    }),
    new winston.transports.File({ 
      filename: 'combined.log' 
    })
  ]
});

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ security —Å–æ–±—ã—Ç–∏–π
logger.info('Login attempt', {
  userId: user.id,
  ip: req.ip,
  success: true,
  timestamp: new Date()
});
```

---

## üí° Best Practices

### Environment Variables

‚úÖ **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ environment variables –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤**
```bash
# .env (–ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ git!)
JWT_SECRET=your-super-secret-key
DB_PASSWORD=your-db-password
TELEGRAM_BOT_TOKEN=your-bot-token
```

‚úÖ **–î–æ–±–∞–≤—å—Ç–µ .env –≤ .gitignore**
```bash
# .gitignore
.env
.env.local
.env.production
*.pem
*.key
*.crt
```

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π**
```
Development: JWT_SECRET_DEV
Staging: JWT_SECRET_STAGING
Production: JWT_SECRET_PROD
```

### Dependency Management

‚úÖ **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
npm audit

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
npm audit fix

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm update
```

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Dependabot –∏–ª–∏ Snyk**
```yaml
# .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/max-webapp"
    schedule:
      interval: "weekly"
  - package-ecosystem: "npm"
    directory: "/server"
    schedule:
      interval: "weekly"
```

### Code Review

‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π code review –¥–ª—è:**
- –ò–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –î–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- –í–∞–ª–∏–¥–∞—Ü–∏–∏ input
- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ static analysis**
```bash
# ESLint security plugin
npm install --save-dev eslint-plugin-security

# .eslintrc.json
{
  "plugins": ["security"],
  "extends": ["plugin:security/recommended"]
}
```

### Error Handling

‚úÖ **–ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ**
```javascript
// ‚ùå –ü–ª–æ—Ö–æ
app.use((err, req, res, next) => {
  res.status(500).json({ 
    error: err.message,
    stack: err.stack  // –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥–∞!
  });
});

// ‚úÖ –•–æ—Ä–æ—à–æ
app.use((err, req, res, next) => {
  logger.error('Internal error', { error: err });
  
  res.status(500).json({ 
    error: process.env.NODE_ENV === 'production' 
      ? 'Internal server error'
      : err.message
  });
});
```

---

## üá™üá∫ GDPR —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

### –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å GDPR, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ –Ω–∞:

1. **–ü—Ä–∞–≤–æ –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** - —á—Ç–æ –º—ã —Å–æ–±–∏—Ä–∞–µ–º –∏ –∑–∞—á–µ–º
2. **–ü—Ä–∞–≤–æ –Ω–∞ –¥–æ—Å—Ç—É–ø** - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ø–∏—é —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö
3. **–ü—Ä–∞–≤–æ –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
4. **–ü—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ** - "–ø—Ä–∞–≤–æ –±—ã—Ç—å –∑–∞–±—ã—Ç—ã–º"
5. **–ü—Ä–∞–≤–æ –Ω–∞ –ø–æ—Ä—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å** - –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –º–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
6. **–ü—Ä–∞–≤–æ –Ω–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ** - –ø—Ä–æ—Ç–∏–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```javascript
// GET /api/users/me/data - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
router.get('/me/data', authenticateToken, async (req, res) => {
  const userData = await User.getAllDataForUser(req.user.id);
  res.json({
    user: userData.profile,
    attendance: userData.attendance,
    groups: userData.groups
  });
});

// DELETE /api/users/me - –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
router.delete('/me', authenticateToken, async (req, res) => {
  // –ê–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  await User.anonymize(req.user.id);
  
  // –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  await User.deletePersonalData(req.user.id);
  
  res.json({ message: 'Account deleted successfully' });
});
```

### Privacy Policy

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–π—Ç–µ:
- **Privacy Policy** - –ø–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
- **Terms of Service** - —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **Cookie Policy** - –ø–æ–ª–∏—Ç–∏–∫–∞ cookies

–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –∏—Ö –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- `https://yourdomain.com/privacy`
- `https://yourdomain.com/terms`

---

## ‚úÖ Security Checklist

### Pre-Deployment

- [ ] –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ environment variables
- [ ] `.env` –≤ `.gitignore`
- [ ] HTTPS –≤–∫–ª—é—á–µ–Ω
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤–∞–ª–∏–¥–Ω—ã
- [ ] Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] CORS –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Helmet middleware –≤–∫–ª—é—á–µ–Ω
- [ ] Input validation –Ω–∞ –≤—Å–µ—Ö endpoints
- [ ] –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã
- [ ] JWT —Å–µ–∫—Ä–µ—Ç –∫—Ä–∏–ø—Ç–æ—Å—Ç–æ–π–∫–∏–π (64+ —Å–∏–º–≤–æ–ª–æ–≤)
- [ ] Bcrypt –¥–ª—è –ø–∞—Ä–æ–ª–µ–π (rounds >= 12)
- [ ] MAX initData –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] RBAC –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Error handling –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (`npm audit`)
- [ ] Static analysis –ø—Ä–æ–π–¥–µ–Ω
- [ ] Privacy Policy –∏ ToS —Ä–∞–∑–º–µ—â–µ–Ω—ã

### Post-Deployment

- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ê–ª–µ—Ä—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- [ ] –ë—ç–∫–∞–ø—ã –ë–î —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
- [ ] Penetration testing –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Security headers –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã (securityheaders.com)
- [ ] SSL rating –ø—Ä–æ–≤–µ—Ä–µ–Ω (ssllabs.com)

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:**
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å failed login attempts

**–ï–∂–µ–º–µ—Å—è—á–Ω–æ:**
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] `npm audit` –ø—Ä–æ–≤–µ—Ä–∫–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±—ç–∫–∞–ø—ã

**–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ:**
- [ ] –†–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (JWT secret, API keys)
- [ ] Security audit –∫–æ–¥–∞
- [ ] Penetration testing

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**Security Team:**
- Email: security@yourdomain.com
- PGP: [–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á]
- MAX: @MaxAttendanceSecurityBot

**Bug Bounty Program:**
- HackerOne: hackerone.com/maxattendance
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ: $50
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ: $2000

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

**–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:**
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP API Security](https://owasp.org/www-project-api-security/)
- [CWE Top 25](https://cwe.mitre.org/top25/)
- [Node.js Security Best Practices](https://nodejs.org/en/docs/guides/security/)

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- [npm audit](https://docs.npmjs.com/cli/v8/commands/npm-audit)
- [Snyk](https://snyk.io/)
- [OWASP ZAP](https://www.zaproxy.org/)
- [Burp Suite](https://portswigger.net/burp)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2024-11-08  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0.0

---

<div align="center">

**üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - –Ω–∞—à –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**

–ï—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ.

</div>